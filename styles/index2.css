    :root{
      --bg: #e9e7df;
      --ink: rgba(0,0,0,.86);
      --muted: rgba(0,0,0,.48);

      --accent: #d3572e;

      /* single border (the “green check” border in your ref) */
      --frame-radius: 6px;
      --frame-border: rgba(0,0,0,.10);

      /* page */
      --page-bg: rgba(247,246,243,.88);
      --page-border: rgba(0,0,0,.10);
      --page-radius: 4px;
      --page-width: 760px;
      --page-height: 960px; /* “Word-ish” viewport page */
      --page-pad: 56px;

      /* soft shadows */
      --shadow-1:
        0 0 0 1px rgba(0,0,0,.05),
        0 1px 1px rgba(0,0,0,.05),
        0 4px 4px rgba(0,0,0,.05),
        0 8px 8px rgba(0,0,0,.05),
        0 16px 16px rgba(0,0,0,.05);
      --shadow-2:
        0 0 0 1px rgba(0,0,0,.05),
        0 2px 2px rgba(0,0,0,.05),
        0 6px 6px rgba(0,0,0,.05),
        0 12px 12px rgba(0,0,0,.05);

      /* blueprint */
      --grid-1: rgba(0,0,0,.05);
      --grid-2: rgba(0,0,0,.025);

      /* motion */
      --motion-fast: 180ms;
      --motion-base: 260ms;
      --motion-slow: 340ms;
      --ease-standard: cubic-bezier(.22,.61,.36,1);
      --ease-emphasis: cubic-bezier(.2,.8,.2,1);

      /* dock tag palette */
      --tag-define: #D3572E;
      --tag-vocab: #6B6F73;
      --tag-help: #8B8377;
      --tag-consult: #7A7F86;
      --tag-unknown: #76706A;
    }
    body[data-theme="ink"]{
      --bg: #d8d4cb;
      --ink: rgba(0,0,0,.9);
      --muted: rgba(0,0,0,.56);
      --accent: #c94f2a;
      --page-bg: rgba(241,239,233,.9);
      --page-border: rgba(0,0,0,.14);
      --grid-1: rgba(0,0,0,.06);
      --grid-2: rgba(0,0,0,.03);
      --tag-define: #c94f2a;
      --tag-vocab: #61656a;
      --tag-help: #746d62;
      --tag-consult: #6f757d;
      --tag-unknown: #6d675f;
    }
    body[data-theme="blueprint"]{
      --bg: #e4e6df;
      --ink: rgba(21,29,35,.88);
      --muted: rgba(21,29,35,.52);
      --accent: #c45b36;
      --page-bg: rgba(244,245,241,.9);
      --page-border: rgba(31,44,52,.16);
      --grid-1: rgba(31,44,52,.06);
      --grid-2: rgba(31,44,52,.03);
      --tag-define: #c45b36;
      --tag-vocab: #5e676d;
      --tag-help: #70746d;
      --tag-consult: #5f6f78;
      --tag-unknown: #656863;
    }

    html, body { height: 100%; margin: 0; overflow: hidden !important; }
    body{
      color: var(--ink);
      background: var(--bg);
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      overflow: hidden; /* lock page scroll */
      cursor: url("../assets/cursors/bibata-ice/default.svg") 4 2, default;
    }
    .pageContent{
      cursor: url("../assets/cursors/bibata-ice/text.svg") 16 16, text;
    }
    button,
    [role="button"],
    .gutter,
    .sliceTopHandle,
    .sliceDockBtn{
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
    }

    /* background grid inspired by lookeandfeel reference */
    body::before{
      content:"";
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: .72;
      background:
        linear-gradient(to right, rgba(114,108,97,.035) 1px, transparent 1px) 0 0 / 188px 188px,
        linear-gradient(to bottom, rgba(114,108,97,.035) 1px, transparent 1px) 0 0 / 188px 188px,
        linear-gradient(to right, rgba(114,108,97,.03) 1px, transparent 1px) 0 0 / 47px 47px,
        linear-gradient(to bottom, rgba(114,108,97,.03) 1px, transparent 1px) 0 0 / 47px 47px,
        linear-gradient(to bottom, rgba(255,255,255,.08), rgba(0,0,0,.01));
    }

    /* app */
    .app{
      height: 100vh;
      display: grid;
      place-items: center;
      padding: 8px;
      box-sizing: border-box;
      overflow-x: hidden;
    }

    /* SINGLE OUTER BORDER ONLY */
    .frame{
      width: min(1200px, 98vw);
      height: calc(100vh - 16px);
      border-radius: var(--frame-radius);
      border: none; /* no outer border */
      background: transparent; /* no frame fill */
      box-shadow: none; /* no floating effect */
      position: relative;
      overflow: hidden;
      overflow-x: hidden;
      backdrop-filter: none;
    }
    .frame::after{
      content: "";
      position: absolute;
      left: 50%;
      top: 18px;
      width: min(var(--page-width), 92vw);
      height: 6px;
      transform: translateX(-50%);
      background: rgba(211,87,46,.9);
      opacity: 0;
      pointer-events: none;
      z-index: 11;
      border-radius: 2px;
      box-shadow: 0 0 0 1px rgba(130,28,18,.14) inset;
    }
    .frame.cmdErrorFlash::after{
      animation: cmdErrorBeep 340ms cubic-bezier(.22,.61,.36,1);
    }
    @keyframes cmdErrorBeep{
      0%{ opacity: 0; transform: translateX(-50%) scaleX(.8); }
      15%{ opacity: .95; transform: translateX(-50%) scaleX(1); }
      45%{ opacity: .65; transform: translateX(-50%) scaleX(.98); }
      100%{ opacity: 0; transform: translateX(-50%) scaleX(1); }
    }

    .chrome{
      position: absolute;
      top: 14px;
      right: 16px;
      display: flex;
      gap: 0;
      opacity: .85;
      z-index: 10;
      align-items: center;
    }
    .themeToggle{
      appearance: none;
      border: 1px solid rgba(0,0,0,.12);
      background: #e5e7eb;
      width: 48px;
      height: 24px;
      border-radius: 999px;
      padding: 0;
      position: relative;
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      transition: background-color 220ms linear, border-color 220ms linear, box-shadow 180ms linear, transform 140ms var(--ease-standard);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.35);
    }
    .themeToggle:hover{
      box-shadow: inset 0 1px 0 rgba(255,255,255,.55), 0 0 0 1px rgba(0,0,0,.06);
      transform: translateY(-1px);
    }
    .themeToggle:focus-visible{
      outline: 1px solid rgba(211,87,46,.55);
      outline-offset: 2px;
    }
    .themeToggleKnob{
      position: absolute;
      top: 0;
      left: 0;
      width: 24px;
      height: 24px;
      border-radius: 999px;
      background: #fff;
      border: 1px solid rgba(0,0,0,.08);
      display: grid;
      place-items: center;
      overflow: hidden;
      transform: translateX(0);
      transition: transform 340ms cubic-bezier(.22,.9,.24,1.02), background-color 220ms linear, border-color 220ms linear;
      box-shadow: 0 2px 5px rgba(0,0,0,.16);
    }
    .themeToggle .themeIcon{
      position: absolute;
      width: 12px;
      height: 12px;
      line-height: 1;
      color: rgba(24,24,24,.88);
      transition: transform 340ms cubic-bezier(.22,.9,.24,1.02), opacity 220ms linear;
      user-select: none;
      pointer-events: none;
    }
    .themeToggle .themeIcon svg{
      width: 12px;
      height: 12px;
      display: block;
      fill: currentColor;
    }
    .themeToggle .themeIcon.sun{
      transform: translate(0, 0);
      opacity: 1;
    }
    .themeToggle .themeIcon.moon{
      transform: translate(-12px, -12px);
      opacity: 0;
    }
    .themeToggle.is-dark{
      background: #1f2937;
      border-color: rgba(17,24,39,.85);
    }
    .themeToggle.is-dark .themeToggleKnob{
      transform: translateX(24px);
      background: #0b0d11;
      border-color: rgba(0,0,0,.42);
    }
    .themeToggle.is-dark .themeIcon{
      color: rgba(232,236,245,.9);
    }
    .themeToggle.is-dark .themeIcon.sun{
      transform: translate(12px, 12px);
      opacity: 0;
    }
    .themeToggle.is-dark .themeIcon.moon{
      transform: translate(0, 0);
      opacity: 1;
    }

    .selectionToolbar{
      position: fixed;
      top: 0;
      left: 0;
      z-index: 30;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px;
      border: 1px solid rgba(0,0,0,.14);
      border-radius: 9px;
      background: rgba(247,246,243,.88);
      box-shadow: 0 3px 12px rgba(0,0,0,.12);
      backdrop-filter: blur(5px);
      opacity: 0;
      pointer-events: none;
      transform: translateY(-6px);
      transition: opacity 140ms ease, transform 180ms cubic-bezier(.22,.61,.36,1);
    }
    .selectionToolbar.isVisible{
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
    }
    .selectionToolbarBtn{
      appearance: none;
      border: 1px solid rgba(0,0,0,.14);
      background: rgba(255,255,255,.72);
      color: rgba(0,0,0,.72);
      font-family: inherit;
      font-size: 10px;
      letter-spacing: .08em;
      text-transform: uppercase;
      line-height: 1;
      border-radius: 6px;
      padding: 6px 8px;
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
    }
    .selectionToolbarBtn:hover{
      border-color: rgba(0,0,0,.26);
      color: rgba(0,0,0,.9);
      background: rgba(255,255,255,.92);
    }
    .selectionToolbarBtn.isPrimary{
      border-color: color-mix(in srgb, var(--accent) 42%, rgba(0,0,0,.16));
      color: var(--accent);
      background: color-mix(in srgb, var(--accent) 9%, rgba(255,255,255,.92));
    }
    body.zenMode .chrome,
    body.zenMode .statusBar{
      opacity: .08;
      transition: opacity 220ms var(--ease-standard);
    }
    body.zenMode .chrome:hover{
      opacity: .5;
    }

    /* scroll area */
    .viewport{
      position: absolute;
      inset: 10px 0 2px 0;
      overflow-y: hidden; /* paper stays fixed; only inner editor scrolls */
      overflow-x: hidden; /* never horizontal scrolling */
      padding: 6px 0 2px;
      scrollbar-width: none;
      scrollbar-color: transparent transparent;
    }
    .viewport::-webkit-scrollbar{
      width: 0;
      height: 0;
    }
    .viewport::-webkit-scrollbar:horizontal{
      height: 0;
    }
    .viewport::-webkit-scrollbar-track{
      background: transparent;
    }
    .viewport::-webkit-scrollbar-thumb{
      background: rgba(0,0,0,.20);
      border-radius: 999px;
      border: 2px solid transparent;
      background-clip: padding-box;
    }
    .viewport::-webkit-scrollbar-thumb:hover{
      background: rgba(0,0,0,.28);
      background-clip: padding-box;
    }

    /* external scrollbar: drives only the inner editor content */
    .outerScroll{
      position: absolute;
      top: 10px;
      right: 2px;
      bottom: 2px;
      width: 10px;
      overflow-y: auto;
      overflow-x: hidden;
      z-index: 7;
      scrollbar-width: thin;
      scrollbar-color: rgba(0,0,0,.22) transparent;
    }
    .outerScroll::-webkit-scrollbar{
      width: 8px;
    }
    .outerScroll::-webkit-scrollbar-track{
      background: transparent;
    }
    .outerScroll::-webkit-scrollbar-thumb{
      background: rgba(0,0,0,.20);
      border-radius: 999px;
      border: 2px solid transparent;
      background-clip: padding-box;
    }
    .outerScroll::-webkit-scrollbar-thumb:hover{
      background: rgba(0,0,0,.28);
      background-clip: padding-box;
    }
    .outerScrollSizer{
      width: 1px;
      height: 100%;
    }

    /* external tags rail: denim-pocket style label, glued to paper edge */
    .sliceDock{
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 0;
      display: block;
      z-index: 1; /* below page layer, above background */
      pointer-events: none;
    }
    .postitLayer{
      position: absolute;
      inset: 0;
      z-index: 1;
      pointer-events: none;
      overflow: visible;
    }
    .postit{
      --postit-bg: #f3f2ee;
      --postit-head: #eceae4;
      --postit-border: rgba(72,74,78,.26);
      --postit-ink: rgba(34,36,40,.9);
      --postit-top: color-mix(in srgb, var(--postit-head) 88%, rgba(255,255,255,.34));
      --postit-side: color-mix(in srgb, var(--postit-bg) 82%, rgba(0,0,0,.12));
      position: absolute;
      width: 164px;
      min-height: 96px;
      border: 1px solid var(--postit-border);
      border-radius: 6px;
      background: var(--postit-bg);
      box-shadow:
        0 1px 0 rgba(255,255,255,.65) inset,
        0 8px 16px rgba(0,0,0,.08);
      color: var(--postit-ink);
      pointer-events: auto;
      display: grid;
      grid-template-rows: 19px auto;
      overflow: hidden;
      transition: none;
      transform-origin: top left;
      transform: perspective(900px) rotateX(4.8deg) rotateY(-7.2deg);
    }
    .postit::before,
    .postit::after{
      content: "";
      position: absolute;
      pointer-events: none;
    }
    .postit::before{
      top: -1px;
      left: 9px;
      right: 9px;
      height: 7px;
      border-radius: 4px 4px 0 0;
      background: var(--postit-top);
      border: 1px solid color-mix(in srgb, var(--postit-border) 70%, transparent);
      border-bottom: none;
      transform: skewX(-16deg);
      transform-origin: left top;
      opacity: .72;
    }
    .postit::after{
      top: 10px;
      bottom: 10px;
      right: -8px;
      width: 10px;
      border-radius: 0 5px 5px 0;
      background: var(--postit-side);
      border: 1px solid color-mix(in srgb, var(--postit-border) 72%, transparent);
      border-left: none;
      transform: skewY(-24deg);
      transform-origin: top left;
      opacity: .8;
    }
    .postit[data-tone="yellow"]{
      --postit-bg: #f2f0e7;
      --postit-head: #e9e6da;
      --postit-border: rgba(103,98,84,.26);
      --postit-ink: rgba(54,52,45,.9);
    }
    .postit[data-tone="green"]{
      --postit-bg: #e7efe9;
      --postit-head: #dde7df;
      --postit-border: rgba(80,98,88,.26);
      --postit-ink: rgba(36,54,44,.88);
    }
    .postit[data-tone="blue"]{
      --postit-bg: #e9edf1;
      --postit-head: #dfe5eb;
      --postit-border: rgba(78,95,117,.27);
      --postit-ink: rgba(32,45,62,.9);
    }
    .postit[data-tone="pink"]{
      --postit-bg: #efe8ec;
      --postit-head: #e8dfe4;
      --postit-border: rgba(112,88,102,.25);
      --postit-ink: rgba(58,39,50,.88);
    }
    .postitHead{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 0 8px 0 6px;
      border-bottom: 1px solid var(--postit-border);
      background: var(--postit-head);
      cursor: url("../assets/cursors/bibata-ice/grab.svg") 10 6, grab;
      user-select: none;
    }
    .postitDots{
      display: inline-flex;
      align-items: center;
      gap: 0;
      pointer-events: auto;
    }
    .postitToneBtn{
      width: 9px;
      height: 9px;
      border: 1px solid rgba(0,0,0,.22);
      border-radius: 999px;
      padding: 0;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.48);
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      background: var(--postit-head);
      transition: transform 120ms ease, filter 120ms ease, background-color 160ms linear;
    }
    .postitToneBtn:hover{
      transform: translateY(-1px);
      filter: saturate(1.05);
    }
    .postitTitle{
      font-size: 8px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: rgba(0,0,0,.44);
      white-space: nowrap;
    }
    .postitBody{
      padding: 8px 9px 9px;
      font-size: 11px;
      line-height: 1.38;
      white-space: pre-wrap;
      overflow-wrap: anywhere;
    }
    .postit.isDragging .postitHead{
      cursor: url("../assets/cursors/bibata-ice/grabbing.svg") 10 6, grabbing;
    }
    .postit.isDragging{
      z-index: 6;
      transform: perspective(900px) rotateX(3.6deg) rotateY(-5.6deg);
    }
    .postit.isDeleteReady{
      --postit-bg: #e6b8b2;
      --postit-head: #dba29b;
      --postit-border: rgba(146,46,40,.5);
      --postit-ink: rgba(74,20,17,.92);
      filter: blur(.7px) saturate(.82);
      opacity: .92;
    }
    .postit.isMinimized{
      min-height: 0;
      height: 19px;
      grid-template-rows: 19px;
    }
    .postit.isMinimized::before,
    .postit.isMinimized::after{
      opacity: .56;
    }
    .postit.isMinimized .postitBody{
      display: none;
    }
    .postit.isSnapping{
      transition:
        left 260ms cubic-bezier(.22,.61,.36,1),
        top 260ms cubic-bezier(.22,.61,.36,1);
    }
    .pageFlowMarkers{
      position: absolute;
      top: 0;
      left: 0;
      width: 0;
      height: 0;
      z-index: 1; /* below paper, above background */
      pointer-events: none;
      overflow: visible;
    }
    .flowMarker{
      position: absolute;
      left: -68px; /* two nudges left for readability */
      appearance: none;
      border: 1px solid color-mix(in srgb, var(--tag-vocab) 44%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-vocab) 10%, #f7f6f3);
      color: var(--tag-vocab);
      border-radius: 5px 5px 0 0;
      padding: 1px 5px;
      min-width: 38px; /* proportional to reduced height */
      height: 10px; /* ~30% shorter */
      line-height: 1;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
      font-family: inherit;
      font-size: 8px;
      letter-spacing: .03em;
      text-transform: uppercase;
      box-shadow: 0 1px 1px rgba(0,0,0,.03);
      transform-origin: top left;
      transform: rotate(-90deg);
      transition: opacity var(--motion-fast) var(--ease-standard), transform var(--motion-fast) var(--ease-standard);
      opacity: .82;
      pointer-events: none;
    }
    .sliceTag{
      appearance: none;
      position: absolute;
      right: 0;
      display: inline-flex;
      align-items: center;
      border: 1px solid rgba(0,0,0,.14);
      background: rgba(247,246,243,.90);
      color: rgba(0,0,0,.68);
      border-radius: 7px 7px 0 0;
      padding: 4px 10px 4px 15px; /* larger left wing */
      text-align: left;
      font-family: inherit;
      font-size: 10px;
      letter-spacing: .08em;
      text-transform: uppercase;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      min-width: 108px;
      height: 22px;
      line-height: 1.1;
      cursor: url("../assets/cursors/bibata-ice/ns-resize.svg") 16 16, ns-resize;
      touch-action: none;
      user-select: none;
      box-shadow: none;
      transform-origin: top right;
      transform: rotate(90deg);
      pointer-events: auto;
      transition:
        border-color var(--motion-fast) linear,
        background-color var(--motion-fast) linear,
        color var(--motion-fast) linear,
        transform var(--motion-fast) var(--ease-standard),
        opacity var(--motion-fast) var(--ease-standard);
      --tag-danger: 0;
    }
    .sliceTag::after{
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: linear-gradient(
        to bottom,
        rgba(184, 58, 48, 0) 0%,
        rgba(184, 58, 48, calc(var(--tag-danger) * .42)) 62%,
        rgba(162, 40, 34, calc(var(--tag-danger) * .88)) 100%
      );
      opacity: 1;
    }
    .sliceTag:hover{
      transform: rotate(90deg) translateY(-1px);
      color: rgba(0,0,0,.82);
    }
    .sliceTag.isDragging{
      cursor: url("../assets/cursors/bibata-ice/grabbing.svg") 10 6, grabbing;
    }
    .sliceTag.isDeleteArmed{
      border-color: rgba(138, 31, 26, .48);
      color: rgba(132, 26, 22, .92);
    }
    .sliceTag.isBouncing{
      transition:
        top 240ms cubic-bezier(.18,.92,.28,1.06),
        border-color var(--motion-fast) linear,
        background-color var(--motion-fast) linear,
        color var(--motion-fast) linear,
        transform var(--motion-fast) var(--ease-standard),
        opacity var(--motion-fast) var(--ease-standard);
    }
    .sliceTag.k-define{
      border-color: color-mix(in srgb, var(--tag-define) 45%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-define) 12%, #f7f6f3);
      color: var(--tag-define);
    }
    .sliceTag.k-vocab{
      border-color: color-mix(in srgb, var(--tag-vocab) 44%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-vocab) 10%, #f7f6f3);
      color: var(--tag-vocab);
    }
    .sliceTag.k-help{
      border-color: color-mix(in srgb, var(--tag-help) 44%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-help) 10%, #f7f6f3);
      color: var(--tag-help);
    }
    .sliceTag.k-consult{
      border-color: color-mix(in srgb, var(--tag-consult) 44%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-consult) 10%, #f7f6f3);
      color: var(--tag-consult);
    }
    .sliceTag.k-unknown{
      border-color: color-mix(in srgb, var(--tag-unknown) 44%, #cfcbc2);
      background: color-mix(in srgb, var(--tag-unknown) 10%, #f7f6f3);
      color: var(--tag-unknown);
    }

    /* single infinite paper */
    .pages{
      display: grid;
      justify-items: center;
      align-items: start;
      gap: 0;
      padding: 0 20px;
      height: 100%;
      overflow-x: hidden;
    }

    .page{
      width: min(var(--page-width), 92vw);
      height: calc(92% + 1.65em);
      min-height: calc(92% + 1.65em);
      max-height: calc(92% + 1.65em);
      background: var(--page-bg);
      border: 1px solid var(--page-border);
      border-radius: var(--page-radius);
      box-shadow: var(--shadow-1);
      position: relative;
      z-index: 2; /* paper above external right-side tags */
      isolation: isolate; /* local stacking context for predictable layering */
      overflow: visible;
      box-sizing: border-box;
    }

    /* light “paper” tint, no extra inner borders */
    .page::before{
      content:"";
      position:absolute;
      inset: 0;
      border-radius: var(--page-radius);
      pointer-events:none;
      z-index: 1; /* base paper skin */
      background:
        radial-gradient(1200px 420px at 50% -10%, rgba(0,0,0,.04), transparent 60%),
        var(--page-bg);
      opacity: 1;
    }

    .pageBreakRail{
      position: absolute;
      inset: 0;
      z-index: 4; /* above text to create clean dead bands at breaks */
      pointer-events: none;
      overflow: hidden;
      display: none;
    }
    .pageBreak{
      position: absolute;
      left: 0;
      right: 0;
      height: var(--break-gap, 33px); /* tuned from editor line-height */
      margin-top: calc(var(--break-gap, 33px) / -2);
      background: transparent;
      opacity: 0;
      transition: opacity 120ms linear;
    }
    .pageBreak .line{
      position: absolute;
      left: 0;
      right: 0;
      display: block;
    }
    .pageBreak .line.top{
      top: 0;
      height: calc((var(--break-gap, 33px) - 1px) / 2);
      background: var(--page-bg); /* clean dead band (no strokes) */
      opacity: 1;
    }
    .pageBreak .line.dash{
      top: calc((var(--break-gap, 33px) - 1px) / 2);
      transform: none;
      border-top: 1px dashed rgba(0,0,0,.22);
    }
    .pageBreak .line.bottom{
      bottom: 0;
      height: calc((var(--break-gap, 33px) - 1px) / 2);
      background: var(--page-bg); /* clean dead band (no strokes) */
      opacity: 1;
    }

    .pageContent{
      position: absolute;
      inset: 0;
      z-index: 3; /* text/cuts above separators */
      padding: calc(var(--page-pad) * .9) var(--page-pad) var(--page-pad);
      outline: none;
      white-space: pre-wrap;
      color: var(--ink);
      font-size: 20px;
      line-height: 1.65;
      letter-spacing: .01em;
      caret-color: var(--accent);
      overflow-y: auto; /* only content scrolls */
      overflow-x: hidden; /* never horizontal scrollbar */
      scrollbar-gutter: auto;
      overscroll-behavior: contain;
      overflow-wrap: anywhere;
      word-break: break-word;
      box-sizing: border-box;
      scrollbar-width: none; /* Firefox: hide internal bar */
      -ms-overflow-style: none; /* old Edge/IE */
    }
    .pageContent.is-empty::before{
      content: attr(data-placeholder);
      position: absolute;
      top: calc(var(--page-pad) * .9);
      left: var(--page-pad);
      right: var(--page-pad);
      color: rgba(0,0,0,.44);
      font-size: 16px;
      line-height: 1.6;
      letter-spacing: .01em;
      white-space: pre-line;
      pointer-events: none;
      user-select: none;
    }
    .pageContent::-webkit-scrollbar{
      width: 0 !important;
      height: 0 !important;
      display: none;
    }
    .pageContent::-webkit-scrollbar:horizontal{
      height: 0;
    }
    .sliceAnchor{
      display: block;
      width: 0;
      height: 0;
      margin: 0;
      padding: 0;
      pointer-events: none;
    }

    /* pagination separator disabled (infinite scroll mode) */
    .tear{
      display: none;
    }

    /* =========================
       SLICES (full width of page)
       ========================= */
    .slice{
      display:block;
      margin: .25em 0;
      position: relative;
      user-select: text;
      white-space: normal; /* do not inherit editor pre-wrap */
      line-height: 1.1;
      --slice-gutter-w: 20px;
      transform-origin: top center;
      will-change: opacity, clip-path;
    }
    .sliceRow,
    .sliceCard,
    .sliceHead,
    .sliceBody{
      transition:
        opacity var(--motion-fast) var(--ease-standard),
        transform var(--motion-base) var(--ease-standard),
        background-color var(--motion-fast) linear,
        min-height var(--motion-fast) var(--ease-emphasis),
        padding var(--motion-fast) var(--ease-standard);
    }
    .sliceRow{
      clip-path: inset(0 0 0 0);
      transition:
        clip-path var(--motion-base) var(--ease-emphasis),
        opacity var(--motion-fast) var(--ease-standard);
    }
    .slice.isEntering .sliceRow{
      clip-path: inset(0 0 96% 0);
      opacity: 0;
    }
    .slice.isEntering .sliceCard{
      opacity: 0;
    }
    .slice.isEntering .sliceBody{
      opacity: 0;
    }

    /* no decorative cut lines */
    .slice::before,
    .slice::after{
      content: none;
    }

    /* === CUT: ocupar 100% do retângulo de escrita (pageContent) === */
    .sliceRow{
      position: relative;
      width: calc(100% + (var(--page-pad) * 2));
      margin-left: calc(-1 * var(--page-pad));
      margin-right: calc(-1 * var(--page-pad));
      padding-top: 14px; /* reserve space for top handle so text never overlaps */
      overflow: visible;
      align-items: stretch;
    }
    .sliceTopHandle{
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      --venom-bar-h: 6px; /* visible canonical minimize strip */
      --venom-gap: 16px; /* more descent room for visible "insist/retract" */
      height: calc(var(--venom-gap) + 2px);
      z-index: 3;
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      user-select: none;
      -webkit-user-select: none;
      overflow: visible;
      background:
        linear-gradient(
          to bottom,
          rgba(124,124,124,.14) 0,
          rgba(124,124,124,.14) var(--venom-bar-h),
          transparent var(--venom-bar-h),
          transparent 100%
        );
      --venom-left: 50%;
      --venom-w: 22px;
      --venom-h: 1px;
      --venom-o: 0;
      --venom-skew: 0deg;
      --venom-squash: 1;
      transition: none;
    }
    .sliceTopHandle::before{
      content: "";
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      height: 1px;
      background: rgba(124,124,124,.42); /* top canonical line */
      pointer-events: none;
    }
    .sliceTopHandle::after{
      content: none; /* lower limit is invisible */
    }
    .sliceTopBlob{
      position: absolute;
      top: var(--venom-bar-h);
      left: var(--venom-left, 50%);
      width: var(--venom-w, 42px);
      height: var(--venom-h, 4px);
      border-radius: 0 0 999px 999px;
      background: rgba(124,124,124,.14); /* exact same tone as top minimize strip */
      opacity: 1;
      transform: translateX(-50%) skewX(var(--venom-skew, 0deg)) scaleX(var(--venom-squash, 1));
      transform-origin: top center;
      filter: none;
      transition: none;
      pointer-events: none;
    }
    .sliceTopHandle:hover{
      background:
        linear-gradient(
          to bottom,
          rgba(124,124,124,.14) 0,
          rgba(124,124,124,.14) var(--venom-bar-h),
          transparent var(--venom-bar-h),
          transparent 100%
        );
    }
    .sliceDockBtn{
      position: absolute;
      top: 10px;
      right: calc(var(--slice-gutter-w) + 12px); /* avoid conflict with close gutter */
      width: 18px;
      height: 12px;
      border: none;
      background: transparent;
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      z-index: 6;
      user-select: none;
      -webkit-user-select: none;
    }
    .sliceDockBtn::before{
      content: "";
      position: absolute;
      left: 2px;
      right: 2px;
      top: 5px;
      height: 2px;
      border-radius: 2px;
      background: rgba(0,0,0,.42);
      transition: background-color var(--motion-fast) linear, transform var(--motion-fast) var(--ease-standard);
    }
    .sliceDockBtn:hover::before{
      background: rgba(211,87,46,.62);
      transform: scaleX(1.08);
    }

    .sliceRow::before{
      content:"";
      position:absolute;
      inset: 0;
      pointer-events:none;
      opacity: 1;
      transition: opacity var(--motion-base) var(--ease-standard);
      background:
        linear-gradient(to right, var(--grid-2) 1px, transparent 1px) 0 0 / 44px 44px,
        linear-gradient(to bottom, var(--grid-2) 1px, transparent 1px) 0 0 / 44px 44px,
        rgba(22, 22, 22, .035);
      box-shadow:
        inset 0 10px 20px rgba(0,0,0,.03),
        inset 0 0 0 1px rgba(0,0,0,.035);
    }

    /* o conteúdo do corte agora é full-width (sem grid, sem padding lateral extra) */
    .sliceCard{
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-rows: auto 1fr;
      border-radius: 0;
      border: none;
      background: transparent;
      box-shadow: none;
      overflow: visible;
      padding: .44em var(--page-pad) .52em;
      margin: 0;
      min-height: 0;
      width: 100%;
      box-sizing: border-box;
      white-space: normal;
    }

    .sliceHead{
      display:flex;
      justify-content: space-between;
      gap: 6px;
      padding-bottom: .12em;
      border-bottom: none;
      align-items: baseline;
      line-height: 1.15;
      white-space: normal;
    }
    .sliceHead::after{
      content: "";
      display: none;
    }

    .badge{
      font-size: 11px;
      letter-spacing: .10em;
      text-transform: uppercase;
      color: rgba(0,0,0,.60);
      display:flex;
      gap: 8px;
      align-items: baseline;
    }
    .badge strong{
      color: var(--accent);
      font-weight: 800;
      letter-spacing: .10em;
      border-left: 3px solid var(--accent);
      padding-left: 10px;
    }

    .sliceMeta{
      font-size: 11px;
      color: rgba(0,0,0,.45);
      white-space: normal;
      overflow-wrap: anywhere;
      text-align: right;
      line-height: 1.15;
    }

    .sliceBody{
      padding-top: 1.08em; /* one-line distance from title/meta with extra breathing */
      display:grid;
      grid-template-columns: 1fr;
      gap: .2em;
      min-height: 0;
      max-height: clamp(188px, 39vh, 372px);
      white-space: normal;
      overflow: hidden;
    }

    /* minimized slice: one compact gray line, full width */
    .slice.isMinimized .sliceCard{
      padding: 0 var(--page-pad);
      grid-template-rows: auto 0fr;
    }
    .slice.isMinimized .sliceRow{
      padding-top: 12px;
    }
    .slice.isMinimized .sliceTopHandle{
      --venom-gap: 12px;
      --venom-bar-h: 5px;
      height: calc(var(--venom-gap) + 2px);
    }
    .slice.isMinimized .sliceRow::before{
      background: rgba(0,0,0,.04);
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.06);
    }
    .slice.isMinimized .sliceHead{
      min-height: 20px;
      height: 20px;
      padding: 2px 0;
      align-items: center;
      border: none;
      overflow: hidden;
    }
    .slice.isMinimized .sliceBody{
      opacity: 0;
      transform: none;
      max-height: 0;
      padding-top: 0;
      pointer-events: none;
      display: none;
    }
    .slice.isMinimized .badge,
    .slice.isMinimized .sliceMeta{
      color: rgba(0,0,0,.62);
      font-size: 10px;
      line-height: 1;
      white-space: nowrap;
    }
    .slice.isMinimized .badge strong{
      border-left: none;
      padding-left: 0;
      color: rgba(0,0,0,.66);
    }
    .slice.isMinimized .sliceHead::after{
      content: "minimizado";
      display: inline-block;
      margin-left: auto;
      color: rgba(0,0,0,.45);
      font-size: 10px;
      letter-spacing: .02em;
      text-transform: lowercase;
      white-space: nowrap;
    }
    .slice:not(.isMinimized) .sliceBody{
      opacity: 1;
      transform: none;
    }
    .slice.isClosing{
      pointer-events: none;
    }
    .slice.isClosing .sliceCard{
      opacity: 0;
      transform: none;
    }
    .slice.isClosing .sliceBody{
      opacity: 0;
      transform: none;
    }
    .slice.isClosing .sliceRow::before{
      opacity: 0;
      transition: opacity .18s ease;
    }
    .slice.isClosing .sliceRow{
      clip-path: inset(0 0 96% 0);
      opacity: 0;
    }

    .panel{
      border-radius: 0;
      border: none;
      background: transparent;
      box-shadow: none;
      overflow: hidden;
      white-space: normal;
      min-height: 0;
      height: 100%;
      backdrop-filter: none;
    }
    .panelHeader{
      padding: 0;
      border-bottom: none;
      font-size: 11px;
      letter-spacing: .08em;
      text-transform: uppercase;
      color: rgba(0,0,0,.52);
      display:flex;
      justify-content: space-between;
      gap: 10px;
    }
    .panelBody{
      /* fixed content theme for all cuts */
      padding: 12px 0 14px;
      color: rgba(0,0,0,.8);
      font-size: 13px;
      line-height: 1.5;
      white-space: normal;
      overflow-wrap: anywhere;
      word-break: break-word;
      min-height: 0;
      max-height: clamp(168px, 34vh, 324px);
      overflow-y: auto;
      overflow-x: hidden;
      overscroll-behavior: contain;
      scrollbar-gutter: stable;
    }
    .panelBody::-webkit-scrollbar{
      width: 6px;
      height: 0;
    }
    .panelBody::-webkit-scrollbar-track{
      background: transparent;
    }
    .panelBody::-webkit-scrollbar-thumb{
      background: rgba(0,0,0,.24);
      border-radius: 999px;
      border: 0;
    }
    .panelBody::-webkit-scrollbar-thumb:hover{
      background: rgba(0,0,0,.30);
    }
    .panelBody{
      scrollbar-width: auto;
      scrollbar-color: rgba(0,0,0,.24) transparent;
    }
    .postitComposer{
      display: grid;
      gap: 8px;
    }
    .postitComposerLabel{
      font-size: 11px;
      letter-spacing: .06em;
      text-transform: uppercase;
      color: rgba(0,0,0,.54);
    }
    .postitComposerInput{
      width: 100%;
      box-sizing: border-box;
      border: 1px solid rgba(0,0,0,.18);
      border-radius: 6px;
      background: rgba(255,255,255,.6);
      color: rgba(0,0,0,.82);
      padding: 8px 10px;
      font: inherit;
      font-size: 14px;
      outline: none;
    }
    .postitComposerInput:focus{
      border-color: rgba(211,87,46,.5);
      box-shadow: 0 0 0 2px rgba(211,87,46,.14);
    }
    .postitComposerHint{
      font-size: 11px;
      color: rgba(0,0,0,.54);
      line-height: 1.28;
    }
    .writerPersonaList{
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 10px;
    }
    .writerPersonaItem{
      appearance: none;
      border: 1px solid rgba(0,0,0,.14);
      background: rgba(255,255,255,.45);
      color: rgba(0,0,0,.78);
      border-radius: 999px;
      padding: 3px 10px;
      font: inherit;
      font-size: 11px;
      letter-spacing: .04em;
      text-transform: lowercase;
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      transition: background-color 140ms linear, border-color 140ms linear, transform 140ms var(--ease-standard);
    }
    .writerPersonaItem:hover{
      background: rgba(211,87,46,.12);
      border-color: rgba(211,87,46,.42);
      transform: translateY(-1px);
    }
    .panelBody p{
      margin: 0 0 12px 0;
    }
    .panelBody h1,
    .panelBody h2,
    .panelBody h3{
      margin: 12px 0 8px 0;
      font-size: 12px;
      letter-spacing: .06em;
      text-transform: uppercase;
      color: rgba(0,0,0,.62);
    }
    .panelBody ul,
    .panelBody ol{
      margin: 0 0 12px 18px;
      padding: 0;
    }
    .panelBody li{
      margin: 0 0 6px 0;
    }
    .panelBody blockquote{
      margin: 0 0 12px 0;
      padding-left: 0;
      border-left: none;
      color: rgba(0,0,0,.66);
      font-style: italic;
    }
    .panelBody code{
      padding: 0;
      border-radius: 0;
      background: transparent;
      font-size: .92em;
      color: rgba(0,0,0,.78);
    }
    .panelBody hr{
      border: 0;
      height: 1px;
      margin: 10px 0 12px 0;
      background: rgba(0,0,0,.1);
    }
    .panelBody table{
      width: 100%;
      border-collapse: collapse;
      border: none;
      margin: 0 0 12px 0;
      background: transparent;
    }
    .panelBody thead,
    .panelBody tbody,
    .panelBody tr,
    .panelBody th,
    .panelBody td{
      border: none;
      background: transparent;
    }
    .panelBody th,
    .panelBody td{
      padding: 3px 0;
      text-align: left;
    }

    .debugPanel{
      opacity: .72;
      font-size: .96em;
    }

    /* gutters NÃO comem largura: ficam fora, por position absolute */
    .gutter{
      position: absolute;
      top: 0;
      bottom: 0;
      width: var(--slice-gutter-w);
      cursor: url("../assets/cursors/bibata-ice/pointer.svg") 9 3, pointer;
      z-index: 4;
      background: rgba(0,0,0,.03);
      opacity: .14;
      transition:
        opacity var(--motion-fast) var(--ease-standard),
        transform var(--motion-fast) var(--ease-standard),
        background-color var(--motion-fast) linear;
    }
    .gutter::before{
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(211,87,46,.14);
      opacity: 0;
      transform: scaleX(1);
      pointer-events: none;
      transition:
        opacity 220ms var(--ease-standard),
        transform 360ms var(--ease-emphasis);
    }
    .gutter::after{
      content: "×";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(.84);
      font-size: 12px;
      line-height: 1;
      color: rgba(0,0,0,.58);
      opacity: 0;
      pointer-events: none;
      transition:
        opacity 120ms var(--ease-standard),
        transform 240ms var(--ease-emphasis);
      transition-delay: 0ms;
    }
    .gutter.left  { left: 0; }
    .gutter.right { right: 0; }
    .gutter.left{
      transform: translateX(-4px);
      transform-origin: left center;
    }
    .gutter.right{
      transform: translateX(4px);
      transform-origin: right center;
    }
    .sliceRow:hover .gutter{
      opacity: .22;
      transform: translateX(0);
    }
    .gutter.left:hover{
      background: rgba(211,87,46,.14);
      opacity: .92;
      transform: translateX(0);
    }
    .gutter.right:hover{
      background: rgba(211,87,46,.14);
      opacity: .92;
      transform: translateX(0);
    }
    .gutter:hover::before{
      opacity: .95;
      transform: scaleX(1.2);
      transition-delay: 900ms; /* reinforce only if cursor stays */
    }
    .gutter:hover::after{
      opacity: .72;
      transform: translate(-50%, -50%) scale(1);
      transition-delay: 980ms; /* show X shortly after delayed expand */
    }

    /* footer status */
    .statusBar{
      display: none;
    }

    @media (max-width: 920px){
      :root{
        --page-pad: 34px;
        --page-height: 900px;
      }
      .sliceBody{ grid-template-columns: 1fr; }
      .slice{ --slice-gutter-w: 14px; }
      .sliceTag{
        font-size: 9px;
      }
      .flowMarker{
        font-size: 9px;
        min-width: 74px;
      }
    }

    @media (prefers-reduced-motion: reduce){
      .sliceRow,
      .sliceCard,
      .sliceHead,
      .sliceBody,
      .sliceTopHandle,
      .gutter,
      .gutter::after,
      .sliceTag,
      .sliceDockBtn::before{
        transition: none !important;
        animation: none !important;
      }
    }
